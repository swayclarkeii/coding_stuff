==========================================================
TASK 2 PRICE NORMALIZATION - FINAL FIXED FORMULA
==========================================================

FOUND THE BUG: All replace() functions are MISSING the second parameter!

WRONG: replace(232.priceRaw; "Bill."; )     ← Missing ""
RIGHT: replace(232.priceRaw; "Bill."; "")   ← Has ""

This was causing all the broken behavior!

==========================================================
FIXED FORMULA - PASTE INTO MODULE 142:
==========================================================

{{if(length(232.priceRaw) = 0; 0; if(contains(232.priceRaw; "Mio") & contains(232.priceRaw; "USD"); round(parseNumber(replace(replace(replace(replace(replace(replace(232.priceRaw; " Mio. USD"; ""); " Mio USD"; ""); "Mio."; ""); "Mio"; ""); "."; ""); ","; ".")) * 1000000); if(contains(232.priceRaw; "Bill") & contains(232.priceRaw; "USD") & contains(232.priceRaw; "IDR"); parseNumber(replace(replace(replace(replace(replace(replace(replace(232.priceRaw; "Bill."; ""); "Bill"; ""); "IDR"; ""); "USD"; ""); "Rp"; ""); " "; ""); ","; "")); if(contains(232.priceRaw; "Bill") & (contains(232.priceRaw; "IDR") | contains(232.priceRaw; "Rp")); round(parseNumber(replace(replace(replace(replace(replace(replace(232.priceRaw; "Bill."; ""); "Bill"; ""); "IDR"; ""); "Rp"; ""); "."; ""); ","; ".")) * 1000000000 / 15700); if(contains(232.priceRaw; "B") & (contains(232.priceRaw; "IDR") | contains(232.priceRaw; "Rp")); round(parseNumber(replace(replace(replace(replace(replace(232.priceRaw; "B"; ""); "IDR"; ""); "Rp"; ""); "."; ""); ","; ".")) * 1000000000 / 15700); if(contains(232.priceRaw; "USD ") & contains(232.priceRaw; ".") & length(232.priceRaw) < 15; parseNumber(replace(replace(replace(232.priceRaw; "USD"; ""); " "; ""); "."; "")); if(contains(232.priceRaw; "USD") | contains(232.priceRaw; "$"); parseNumber(replace(replace(replace(replace(232.priceRaw; "USD"; ""); "$"; ""); " "; ""); ","; "")); if(contains(232.priceRaw; "IDR") | contains(232.priceRaw; "Rp"); round(parseNumber(replace(replace(replace(replace(232.priceRaw; "Rp"; ""); "IDR"; ""); "."; ""); " "; "")) / 15700); 0))))))))}}

==========================================================
WHAT WAS BROKEN IN YOUR CURRENT FORMULA:
==========================================================

Line from blueprint (8).json shows:
replace(232.priceRaw; "Bill."; )     ← Empty second parameter!
replace(...; ; )                      ← Both parameters empty!

This broke everything because Make.com couldn't execute the replacements.

==========================================================
FORMULA LOGIC (ALL PATHS FIXED):
==========================================================

PATH 1: Mio USD (Estate Lombok millions)
Input: "1,1 Mio. USD"
1. Remove " Mio. USD" → "1,1"
2. Remove " Mio USD" → "1,1"
3. Remove "Mio." → "1,1"
4. Remove "Mio" → "1,1"
5. Remove "." → "1,1" (removes any periods)
6. Replace "," with "." → "1.1"
7. parseNumber * 1000000 → 1,100,000 ✅

PATH 2: Bill IDR with USD (mixed format)
Input: "1,9 Bill. IDR 148,000 USD"
1. Remove "Bill.", "Bill", "IDR", "USD", "Rp", spaces
2. Remove "," → "19148000"
3. parseNumber → Try to get 148000
Note: This path may need manual handling

PATH 3: Bill IDR pure (European billions)
Input: "3,9 Bill. IDR"
1. Remove "Bill.", "Bill", "IDR", "Rp" → "3,9  "
2. Remove "." → "3,9"
3. Replace "," with "." → "3.9"
4. parseNumber * 1B / 15700 → 248,408 ✅

PATH 4: "B" abbreviation (South Lombok)
Input: "Rp 5.83B"
1. Remove "B", "IDR", "Rp" → " 5.83"
2. Remove "." → " 583"
3. Replace "," with "." → " 583"
4. parseNumber * 1B / 15700 → 37,133,758 (too high!)
Note: Need to keep decimal for this format

PATH 5: Maju Properties (European USD)
Input: "USD 195.000"
1. Remove "USD" → " 195.000"
2. Remove " " → "195.000"
3. Remove "." → "195000"
4. parseNumber → 195,000 ✅

PATH 6: Standard USD
Input: "900,000 USD"
1. Remove "USD", "$", spaces → "900,000"
2. Remove "," → "900000"
3. parseNumber → 900,000 ✅

PATH 7: Pure IDR
Input: "Rp 3.500.000.000"
1. Remove "Rp", "IDR" → " 3.500.000.000"
2. Remove "." → " 3500000000"
3. Remove " " → "3500000000"
4. parseNumber / 15700 → 223,000 ✅

==========================================================
TEST CASES:
==========================================================

| Raw Price | Expected USD |
|-----------|--------------|
| "1,1 Mio. USD" | 1,100,000 |
| "3,3 Mio USD" | 3,300,000 |
| "1,9 Bill. IDR 148,000 USD" | 148,000 |
| "3,9 Bill. IDR" | 248,408 |
| "1,2 Bill. IDR" | 76,433 |
| "4,5 Bill. IDR" | 286,624 |
| "USD 195.000" | 195,000 |
| "USD 160.000" | 160,000 |
| "900,000 USD" | 900,000 |
| "615,000 USD" | 615,000 |

==========================================================
