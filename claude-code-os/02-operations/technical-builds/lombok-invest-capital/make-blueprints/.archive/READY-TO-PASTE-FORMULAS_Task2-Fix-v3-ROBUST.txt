==========================================================
TASK 2 PRICE NORMALIZATION - FIXED FORMULA v3 ROBUST
==========================================================

ERROR: '1.1.' is not a valid number
ROOT CAUSE: Trailing period left after removing "Mio" from "Mio."

SOLUTION: More aggressive period removal in the right order

PASTE THIS INTO THE "Normalize Price USD for Task 2" MODULE:
----------------------------------------------------------

{{if(contains(232.priceRaw; "Rp") | contains(232.priceRaw; "IDR"); if(contains(232.priceRaw; "Billion") | contains(232.priceRaw; "Bill") | contains(232.priceRaw; "Miliar"); round(parseNumber(replace(replace(replace(replace(replace(replace(replace(replace(232.priceRaw; "Rp "; ""); "Rp"; ""); "IDR "; ""); " Billion"; ""); " Bill."; ""); " Bill"; ""); "."; ""); ","; ".")) * 1000000000 / 15700); if(contains(232.priceRaw; "Million") | contains(232.priceRaw; "Mio") | contains(232.priceRaw; "Juta"); round(parseNumber(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(232.priceRaw; "Rp "; ""); "Rp"; ""); "IDR "; ""); " Million"; ""); " Mio."; ""); " Mio"; ""); "Mio."; ""); "Mio"; ""); "."; ""); ","; ".")) * 1000000 / 15700); round(parseNumber(replace(replace(replace(replace(232.priceRaw; "Rp"; ""); "IDR"; ""); "."; ""); ","; "")) / 15700))); if(contains(232.priceRaw; "$") | contains(232.priceRaw; "USD"); if(contains(232.priceRaw; "Mio"); round(parseNumber(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(232.priceRaw; "$"; ""); "USD"; ""); " USD"; ""); " Mio."; ""); " Mio"; ""); "Mio."; ""); "Mio"; ""); " "; ""); "."; ""); " "; ""); ","; ".")) * 1000000); if(contains(232.priceRaw; "K"); round(parseNumber(replace(replace(replace(replace(replace(232.priceRaw; "$"; ""); "USD"; ""); ","; ""); "."; ""); "K"; "")) * 1000); parseNumber(replace(replace(replace(replace(232.priceRaw; "$"; ""); "USD"; ""); " "; ""); ","; "")))); if(contains(232.priceRaw; "€") | contains(232.priceRaw; "EUR"); round(parseNumber(replace(replace(replace(replace(232.priceRaw; "€"; ""); "EUR"; ""); "."; ""); ","; ".")) * 1.1); 0)))}}

==========================================================
KEY CHANGES FROM v2:
==========================================================

1. ✅ USD Mio path: Remove ALL periods BEFORE converting comma to decimal
   Order: Remove text → Remove ALL spaces → Remove ALL periods → Convert comma to period

2. ✅ IDR Billion/Million paths: Remove periods before comma conversion

3. ✅ USD K path: Remove periods (thousands separators in European format)

4. ✅ Regular USD path: Remove spaces before comma replacement

The key insight: ALWAYS remove periods (thousands separators) BEFORE converting comma to decimal point!

==========================================================
LOGIC FOR "1,1 Mio. USD":
==========================================================

1. Contains "Mio" → Enter Mio path
2. Remove "$" → "1,1 Mio. USD"
3. Remove "USD" → "1,1 Mio. "
4. Remove " USD" → "1,1 Mio. "
5. Remove " Mio." → "1,1 "
6. Remove " Mio" → "1,1 "
7. Remove "Mio." → "1,1 "
8. Remove "Mio" → "1,1 "
9. Remove " " (spaces) → "1,1"
10. Remove "." → "1,1" (no period to remove)
11. Remove " " again → "1,1"
12. Replace "," with "." → "1.1"
13. parseNumber("1.1") → 1.1 ✅
14. 1.1 * 1000000 → 1,100,000 ✅

==========================================================
LOGIC FOR "1.234,50 Mio. USD" (European with thousands):
==========================================================

1. Contains "Mio" → Enter Mio path
2. Remove currency/text → "1.234,50 "
3. Remove spaces → "1.234,50"
4. Remove "." (thousands separator) → "1234,50"
5. Replace "," with "." → "1234.50"
6. parseNumber("1234.50") → 1234.5 ✅
7. 1234.5 * 1000000 → 1,234,500,000 ✅

==========================================================
TESTING CHECKLIST:
==========================================================

After pasting, test with these sample values:

✅ "1,1 Mio. USD"     → Should output: 1100000
✅ "900,000 USD"      → Should output: 900000
✅ "615,000 USD"      → Should output: 615000
✅ "1,9 Bill. IDR"    → Should output: 121019
✅ "4,5 Bill. IDR"    → Should output: 286624
✅ "249,000 USD"      → Should output: 249000

==========================================================
SAME FIX FOR TASK 3:
==========================================================

{{if(contains(233.priceRaw; "Rp") | contains(233.priceRaw; "IDR"); if(contains(233.priceRaw; "Billion") | contains(233.priceRaw; "Bill") | contains(233.priceRaw; "Miliar"); round(parseNumber(replace(replace(replace(replace(replace(replace(replace(replace(233.priceRaw; "Rp "; ""); "Rp"; ""); "IDR "; ""); " Billion"; ""); " Bill."; ""); " Bill"; ""); "."; ""); ","; ".")) * 1000000000 / 15700); if(contains(233.priceRaw; "Million") | contains(233.priceRaw; "Mio") | contains(233.priceRaw; "Juta"); round(parseNumber(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(233.priceRaw; "Rp "; ""); "Rp"; ""); "IDR "; ""); " Million"; ""); " Mio."; ""); " Mio"; ""); "Mio."; ""); "Mio"; ""); "."; ""); ","; ".")) * 1000000 / 15700); round(parseNumber(replace(replace(replace(replace(233.priceRaw; "Rp"; ""); "IDR"; ""); "."; ""); ","; "")) / 15700))); if(contains(233.priceRaw; "$") | contains(233.priceRaw; "USD"); if(contains(233.priceRaw; "Mio"); round(parseNumber(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(233.priceRaw; "$"; ""); "USD"; ""); " USD"; ""); " Mio."; ""); " Mio"; ""); "Mio."; ""); "Mio"; ""); " "; ""); "."; ""); " "; ""); ","; ".")) * 1000000); if(contains(233.priceRaw; "K"); round(parseNumber(replace(replace(replace(replace(replace(233.priceRaw; "$"; ""); "USD"; ""); ","; ""); "."; ""); "K"; "")) * 1000); parseNumber(replace(replace(replace(replace(233.priceRaw; "$"; ""); "USD"; ""); " "; ""); ","; "")))); if(contains(233.priceRaw; "€") | contains(233.priceRaw; "EUR"); round(parseNumber(replace(replace(replace(replace(233.priceRaw; "€"; ""); "EUR"; ""); "."; ""); ","; ".")) * 1.1); 0)))}}

==========================================================
